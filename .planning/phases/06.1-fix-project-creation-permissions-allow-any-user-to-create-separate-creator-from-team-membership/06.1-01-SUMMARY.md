---
phase: 06.1-fix-project-creation-permissions-allow-any-user-to-create-separate-creator-from-team-membership
plan: 01
subsystem: auth
tags: [permissions, firestore-rules, authentication, authorization]

# Dependency graph
requires:
  - phase: 04-roadmap-and-project-structure
    provides: Permission system (permissions.ts) and Firestore security rules
provides:
  - Any authenticated user can create projects (not just mentors)
  - Any authenticated resource owner can edit/manage their resources (not just mentors)
  - Updated permission tests covering new authorization model
affects: [06.1-02, project-creation, team-formation, project-management]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Owner-based permissions now use isAuthenticated instead of isAcceptedMentor"
    - "Consistent permission model across projects and roadmaps"

key-files:
  created: []
  modified:
    - src/lib/permissions.ts
    - firestore.rules
    - src/app/api/projects/route.ts
    - src/__tests__/permissions.test.ts

key-decisions:
  - "canOwnerOrAdminAccess now checks isAuthenticated(user) && isOwner instead of isAcceptedMentor && isOwner"
  - "Project creation permission changed from mentor-only to any authenticated user"
  - "Roadmap creation remains mentor-only (no change)"

patterns-established:
  - "Permission functions check isAuthenticated for owner-based access, not role-based"
  - "Firestore rules use isSignedIn() for project creation instead of isAcceptedMentor()"

# Metrics
duration: 2min
completed: 2026-02-11
---

# Phase 06.1 Plan 01: Fix Project Creation Permissions Summary

**Any authenticated user can now create and manage projects; permission system updated to allow non-mentor creators full ownership rights**

## Performance

- **Duration:** 2 minutes
- **Started:** 2026-02-11T10:26:31Z
- **Completed:** 2026-02-11T10:28:32Z
- **Tasks:** 2
- **Files modified:** 4

## Accomplishments
- Fixed PERM-01 bug: any authenticated user (mentor, mentee, pending) can create projects
- Fixed canOwnerOrAdminAccess bug: any authenticated owner can edit/manage their resources (not just mentors)
- Updated Firestore security rules to allow any signed-in user to create projects
- Updated all 53 permission tests to reflect new authorization model (increased from 50 tests)

## Task Commits

Each task was committed atomically:

1. **Task 1: Fix permission functions and Firestore rules** - `6a634f1` (feat)
2. **Task 2: Update permission tests for new authorization model** - `7cf72c2` (test)

## Files Created/Modified
- `src/lib/permissions.ts` - Updated canCreateProject to use isAuthenticated; fixed canOwnerOrAdminAccess to allow any authenticated owner
- `firestore.rules` - Updated project creation rule to use isSignedIn() instead of isAcceptedMentor()
- `src/app/api/projects/route.ts` - Updated error message to "Only authenticated users can create projects"
- `src/__tests__/permissions.test.ts` - Added 3 new test cases, updated 2 existing expectations (53 total tests, all passing)

## Decisions Made
- **canOwnerOrAdminAccess helper function fix:** Changed from `isAcceptedMentor(user) && isOwner(user, resource)` to `isAuthenticated(user) && isOwner(user, resource)`. This ensures any authenticated user who owns a resource can edit/manage it, not just accepted mentors. Without this fix, a mentee who creates a project would be unable to manage their own project.
- **Consistent permission model:** Project creation now uses the same authentication check as other authenticated actions (isAuthenticated), while roadmap creation remains mentor-only (isAcceptedMentor) as originally designed.
- **Updated JSDoc comments:** All function comments now reflect "only authenticated users" or "only project creator" instead of "only accepted mentors" or "only project creator (if accepted mentor)" for consistency.

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

Ready for Phase 06.1 Plan 02 (Join/Leave endpoints and UI updates). All permission functions and tests passing with new authorization model.

## Self-Check: PASSED

All files and commits verified:
- ✓ src/lib/permissions.ts exists
- ✓ firestore.rules exists
- ✓ src/app/api/projects/route.ts exists
- ✓ src/__tests__/permissions.test.ts exists
- ✓ Commit 6a634f1 exists
- ✓ Commit 7cf72c2 exists

---
*Phase: 06.1-fix-project-creation-permissions-allow-any-user-to-create-separate-creator-from-team-membership*
*Completed: 2026-02-11*
