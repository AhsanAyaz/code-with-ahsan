---
phase: 06.1-fix-project-creation-permissions-allow-any-user-to-create-separate-creator-from-team-membership
plan: 02
subsystem: api, ui
tags: [nextjs, firestore, discord, batch-writes, react, project-collaboration]

# Dependency graph
requires:
  - phase: 06.1-01
    provides: Updated permission system allowing any authenticated user to create projects
provides:
  - POST /api/projects/[id]/join endpoint for creator self-join as member
  - Updated leave endpoint allowing creator-members to leave while retaining ownership
  - TeamRoster component with creator deduplication and dual-role badges
  - Join Project button for non-member creators on project detail page
  - Updated Leave button visibility for all members (including creator-members)
  - Create Project button visible to all authenticated users on discover and My Projects pages
affects: [06.2, project-team-management, discord-integration]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Creator membership separation: creator role is distinct from team membership"
    - "Dual-role UI pattern: badge shows 'Creator · Member' when user has both roles"
    - "Deduplication filtering: filter creator from members array to prevent duplicate rendering"
    - "Conditional confirmation messages: different warnings for creator vs regular member leaving"

key-files:
  created:
    - src/app/api/projects/[id]/join/route.ts
  modified:
    - src/app/api/projects/[id]/leave/route.ts
    - src/components/projects/TeamRoster.tsx
    - src/app/projects/[id]/page.tsx
    - src/app/projects/discover/page.tsx
    - src/app/projects/my/page.tsx

key-decisions:
  - "Creator join endpoint is creator-only (not for general member join via applications)"
  - "Creator-members can leave but retain ownership permissions (lose Discord access only)"
  - "TeamRoster always shows creator separately, never as part of members list"
  - "Dual-role badge uses middot separator: 'Creator · Member' vs outline 'Creator'"
  - "Create Project button shown to all authenticated users (removed mentor-only restriction)"

patterns-established:
  - "Role separation pattern: ownership (creator) is independent from participation (member)"
  - "Hands-off creator pattern: creator can oversee project without being in team roster or Discord"
  - "Active creator pattern: creator can join as member to get Discord access and appear in roster"
  - "UI visibility based on authentication only (not role) for project creation"

# Metrics
duration: 3min
completed: 2026-02-11
---

# Phase 06.1 Plan 2: Creator Join/Leave and UI Updates Summary

**Creator self-join endpoint with batch writes, dual-role TeamRoster badges, and Create Project buttons for all authenticated users**

## Performance

- **Duration:** 3 min
- **Started:** 2026-02-11T10:31:17Z
- **Completed:** 2026-02-11T10:34:34Z
- **Tasks:** 2
- **Files modified:** 6

## Accomplishments
- Creator can join their own project as a team member via dedicated endpoint
- Creator-members can leave while retaining ownership permissions
- TeamRoster shows dual-role "Creator · Member" badge with deduplication
- Any authenticated user can access Create Project button (removed mentor-only restriction)

## Task Commits

Each task was committed atomically:

1. **Task 1: Create join endpoint and fix leave endpoint** - `5a1268c` (feat)
2. **Task 2: Update TeamRoster, project detail page, discover page, and My Projects page UI** - `23bcee9` (feat)

## Files Created/Modified
- `src/app/api/projects/[id]/join/route.ts` - POST endpoint for creator self-join with batch writes
- `src/app/api/projects/[id]/leave/route.ts` - Removed creator-blocking logic, membership check only
- `src/components/projects/TeamRoster.tsx` - Creator deduplication filter and dual-role badge display
- `src/app/projects/[id]/page.tsx` - Join/Leave buttons with conditional visibility and confirmation messages
- `src/app/projects/discover/page.tsx` - Create Project button for all authenticated users
- `src/app/projects/my/page.tsx` - Create Project button in header on Created tab

## Decisions Made
- **Creator-only join endpoint:** Dedicated endpoint (not reusing application flow) ensures only creator can self-join without approval process
- **Leave retains ownership:** Creator-members can leave to remove Discord access while keeping project management permissions
- **Deduplication in TeamRoster:** Filter creator from members array at render time prevents duplicate display when creator is also a member
- **Dual-role badge pattern:** Visual distinction via "Creator · Member" (solid) vs "Creator" (outline) shows membership status at a glance
- **Universal project creation:** Removed mentor role check to enable any authenticated user to create projects (aligns with Phase 06.1 goal)

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None - all implementations followed existing patterns (batch writes, Discord non-blocking operations, composite keys).

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness
- Creator join/leave flow complete with proper UI feedback
- Team roster correctly displays dual-role creators
- Project creation democratized (any authenticated user can create)
- Ready for Phase 06.2 (project discovery UI) and future team management features
- Pattern established for role separation that can be reused for future features (e.g., project transfer, co-ownership)

## Self-Check: PASSED

All files exist:
- ✓ src/app/api/projects/[id]/join/route.ts
- ✓ src/app/api/projects/[id]/leave/route.ts
- ✓ src/components/projects/TeamRoster.tsx
- ✓ src/app/projects/[id]/page.tsx
- ✓ src/app/projects/discover/page.tsx
- ✓ src/app/projects/my/page.tsx

All commits exist:
- ✓ 5a1268c (Task 1: join/leave endpoints)
- ✓ 23bcee9 (Task 2: UI updates)

---
*Phase: 06.1-fix-project-creation-permissions-allow-any-user-to-create-separate-creator-from-team-membership*
*Completed: 2026-02-11*
